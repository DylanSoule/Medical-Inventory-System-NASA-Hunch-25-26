CREATE TABLE `medications` (
  `barcode` VARCHAR(12) NOT NULL,
  `name` TEXT NOT NULL,
  `amount_in_unit` INT NOT NULL,
  `type` TEXT NOT NULL,
  `dosage` TEXT NOT NULL,
  `expiration_date` DATE NOT NULL,
  PRIMARY KEY (`barcode`)
);

CREATE TABLE `in_inventory` (
  `id` INT AUTO_INCREMENT,
  `barcode` VARCHAR(12) NOT NULL,
  `estimated_amount_remaining` INT NOT NULL,
  `location` TEXT NOT NULL,
  PRIMARY KEY (`id`),
  FOREIGN KEY (`barcode`)
      REFERENCES `medications`(`barcode`)
);

CREATE TABLE `people` (
  `id` INT AUTO_INCREMENT,
  `name` TEXT NOT NULL,
  PRIMARY KEY (`id`)
);

CREATE TABLE `prescriptions` (
  `id` INT AUTO_INCREMENT,
  `barcode` VARCHAR(12) NOT NULL,
  `dose` INT,
  `time` TIME,
  `leeway` INT,
  `as_needed` BOOLEAN NOT NULL,
  PRIMARY KEY (`id`)
);

CREATE TABLE `assigned_prescriptions` (
  `person_id` INT NOT NULL,
  `prescription_id` INT NOT NULL,
  FOREIGN KEY (`person_id`)
      REFERENCES `people`(`id`),
  FOREIGN KEY (`prescription_id`)
      REFERENCES `prescriptions`(`id`),
  PRIMARY KEY `Prescription` (`person_id`, `prescription_id`)
);

CREATE TABLE `history` (
  `id` INT AUTO_INCREMENT,
  `barcode` VARCHAR(12) NOT NULL,
  `inventory_id` INT NOT NULL,
  `person_id` INT NOT NULL,
  `type_of_use` TEXT NOT NULL,
  `time_of_use` DATETIME NOT NULL,
  `amnt_change` INT NOT NULL
  PRIMARY KEY (`id`),
  FOREIGN KEY (`barcode`)
      REFERENCES `medications`(`barcode`),
  FOREIGN KEY (`inventory_id`)
      REFERENCES `in_inventory`(`id`),
  FOREIGN KEY (`person_id`)
      REFERENCES `people`(`id`)
);

